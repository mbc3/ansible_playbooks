---
- name: Install SSHD on HomeLab LXC containers
  become: true
  hosts: proxmox_all_lxc

  pre_tasks:
    - name: Update all packages
      ansible.builtin.dnf:
        name: "*"
        state: latest
  tasks:
    - name: Install SSHD
      ansible.builtin.dnf:
        name: openssh-server
        state: present
    - name: Copy MBC SSH key
      ansible.posix.authorized_key:
        user: root
        state: present
        key: "{{ lookup('file', '/home/mbc/.ssh/id_ed25519.pub') }}"
